(this.webpackJsonpmilap=this.webpackJsonpmilap||[]).push([[13],{534:function(e,t,a){"use strict";(function(e){var n=a(163),o=a(164),s=a(166),r=a(165),c=a(1),l=a.n(c),i=a(547),m=a(549),u=a(551),d=a(553),g=a(541),h=a.n(g),p=(a(523),a(530)),f=a.n(p),v=a(112),b=(a(555),f()("".concat(e.config.backendURL,"/"))),y=function(e){Object(s.a)(a,e);var t=Object(r.a)(a);function a(e){var o;return Object(n.a)(this,a),(o=t.call(this,e)).init=function(){},o.getReqData=function(){var e=o.state.messages;return{roomName:o.props.roomName,lastMsgId:e&&e.length>0?e[e.length-1].id+1:-1}},o.fetchMessages=function(){var e=arguments.length>1?arguments[1]:void 0,t=o.state.messages;if(delete e.room,void 0!==t&&null!==t&&void 0!==e&&null!==e){console.log("Inside");var a=t;a.push(e),o.setState({messages:a})}console.log("Inside fetch Message",o.state.messages,e)},o.renderMessages=function(){var e=o.state.messages;if(e){console.log(e),console.log(e.length);for(var t=0,a=e.length,n=[];t<a;){var s=e[t-1],r=e[t],c=e[t+1],i=r.sender===o.state.MY_USER_ID,m=h()(r.timestamp),u=!0,g=!0,p=!0;if(s){var f=h()(s.timestamp),v=h.a.duration(m.diff(f));s.author===r.author&&v.as("hours")<1&&(u=!1),v.as("hours")<1&&(p=!1)}if(c){var b=h()(c.timestamp),y=h.a.duration(b.diff(m));c.author===r.author&&y.as("hours")<1&&(g=!1)}1==a&&(g=!1),n.push(l.a.createElement(d.a,{key:t,isMine:i,startsSequence:u,endsSequence:g,showTimestamp:p,data:r})),t+=1}return console.log(n),n}console.log("no messages")},o.updateMsg=function(e){var t=[e],a=o.formatMsgs(t,!0);t=o.state.messages.concat(a),o.setState({messages:t})},o.state={MY_USER_ID:o.props.username,messages:o.props.msgs,change:!1,lastMsgId:0},o}return Object(o.a)(a,[{key:"componentDidMount",value:function(){var e=this;this.setState({messages:this.props.msgs}),b.on("newMessage",(function(t){console.log("New Message Arrived",t,e.state.MY_USER_ID),"dashboard"!==e.props.roomName&&e.props.roomName==t.room&&void 0!==e.state.messages&&e.state.MY_USER_ID!==t.sender&&e.fetchMessages(!0,t)}))}},{key:"componentDidUpdate",value:function(e){window.scrollTo(0,document.querySelector("#message-list").scrollHeight),e.roomName!==this.props.roomName&&(this.setState({messages:this.props.msgs}),this.init())}},{key:"formatMsgs",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],a=this.state.messages;return t&&(a=[]),e.forEach((function(e,t){var n={};n.id=e.id,n.sender=e.sender,n.msg=e.msg,n.timestamp=(new Date).getTime(),a.push(n)})),a}},{key:"render",value:function(){return l.a.createElement("div",{className:"message-list bg-dark"},l.a.createElement(m.a,{title:this.props.roomName}),l.a.createElement("div",{className:"message-list-container bg-dark",id:"message-list"},this.renderMessages()),l.a.createElement(i.a,{rightItems:[l.a.createElement(u.a,{key:"photo",icon:"ion-ios-camera"}),l.a.createElement(u.a,{key:"image",icon:"ion-ios-image"}),l.a.createElement(u.a,{key:"audio",icon:"ion-ios-mic"}),l.a.createElement(u.a,{key:"money",icon:"ion-ios-card"}),l.a.createElement(u.a,{key:"games",icon:"ion-logo-game-controller-b"}),l.a.createElement(u.a,{key:"emoji",icon:"ion-ios-happy"})],roomName:this.props.roomName,callback:this.updateMsg}))}}]),a}(c.Component);t.a=Object(v.connect)((function(e){return console.log(e),{username:e.loginReducer.username}}))(y)}).call(this,a(60))},546:function(e,t,a){"use strict";a.r(t);var n=a(536),o=a(163),s=a(164),r=a(167),c=a(166),l=a(165),i=a(1),m=a.n(i),u=a(20),d=a(527),g=a(924),h=a(921),p=a(922),f=a(685),v=a(686),b=(a(575),a(518)),y=a.n(b),E=a(533),k=a(534),N=a(556),S=a(558),C=(a(523),a(614)),O=a(612);var j=function(e){Object(c.a)(a,e);var t=Object(l.a)(a);function a(e){var n;Object(o.a)(this,a),(n=t.call(this,e)).changeRoomType=function(){n.setState({roomType:"Public"===n.state.roomType?"Private":"Public"}),d.store.addNotification({title:"Room Type Changed",message:"Changed room type to ".concat(n.state.roomType),type:"success",container:"top-right",animationIn:["animated","fadeIn"],animationOut:["animated","fadeOut"],dismiss:{duration:3e3,pauseOnHover:!0}})},console.log(e);var s=function(e){var t,a=e.lastIndexOf("/");return t=e.slice(a+1),console.log(t),t}(n.props.location.pathname);return n.toggle=n.toggle.bind(Object(r.a)(n)),n.state={activeTab:"1",change:!1,roomName:s,roomType:"Public",path:e.location.pathname},n.getRoomInfo=n.getRoomInfo.bind(Object(r.a)(n)),n}return Object(s.a)(a,[{key:"getRoomInfo",value:function(e){console.log("nothing to say.")}},{key:"componentDidMount",value:function(){console.log("mounting")}},{key:"toggle",value:function(e){this.state.activeTab!==e&&this.setState({activeTab:e})}},{key:"render",value:function(){var e=this;console.log(this.props);var t=this.props;t.children,Object(n.a)(t,["children"]);return m.a.createElement(m.a.Fragment,null,m.a.createElement(g.a,{tabs:!0},m.a.createElement(h.a,null,m.a.createElement(p.a,{className:y()({active:"1"===this.state.activeTab}),onClick:function(){e.toggle("1")}},m.a.createElement("i",{className:"icon-list"}))),m.a.createElement(h.a,null,m.a.createElement(p.a,{className:y()({active:"2"===this.state.activeTab}),onClick:function(){e.toggle("2")}},m.a.createElement("i",{className:"icon-speech"}))),m.a.createElement(h.a,null,m.a.createElement(p.a,{className:y()({active:"3"===this.state.activeTab}),onClick:function(){e.toggle("3")}},m.a.createElement("i",{className:"icon-settings"})))),m.a.createElement(f.a,{activeTab:this.state.activeTab},m.a.createElement(v.a,{tabId:"1"},m.a.createElement(C.a,{className:"bg-dark"},m.a.createElement(O.a,null,m.a.createElement(N.a,{roomName:this.props.roomName}),m.a.createElement(S.a,{users:this.props.users,guests:this.props.guests,roomName:this.props.roomName})))),m.a.createElement(v.a,{tabId:"2",className:"p-3 bg-dark",key:this.state.change},m.a.createElement(k.a,{roomName:this.props.roomName,msgs:this.props.msgs})),m.a.createElement(v.a,{tabId:"3",className:"p-3 bg-dark"},m.a.createElement("h6",null,"Settings"),m.a.createElement("div",{className:"aside-options"},m.a.createElement("div",{className:"clearfix mt-4"},m.a.createElement("small",null,m.a.createElement("button",{class:"btn btn-dark"},"Change Room Icon"))),m.a.createElement("div",null,m.a.createElement("small",{className:"text-muted"},"Set the Room Icon."))),m.a.createElement("div",{className:"aside-options"},m.a.createElement("div",{className:"clearfix mt-3"},m.a.createElement("small",null,m.a.createElement("button",{class:"btn btn-dark",onClick:this.changeRoomType},"Change Room Type"))),m.a.createElement("div",null,m.a.createElement("small",{className:"text-muted"},"Set the active room to Private / Public."))),m.a.createElement("div",{className:"aside-options"},m.a.createElement("div",{className:"clearfix mt-3"},m.a.createElement("small",null,m.a.createElement("b",null,"More settings")),m.a.createElement(E.k,{className:"float-right",variant:"pill",label:!0,color:"success",defaultChecked:!0,size:"sm"}))))))}}]),a}(i.Component);t.default=Object(u.o)(j)},547:function(e,t,a){"use strict";(function(e){a.d(t,"a",(function(){return u}));var n=a(539),o=a.n(n),s=a(540),r=a(572),c=a(1),l=a.n(c),i=(a(548),a(523)),m=a.n(i);function u(t){var a=Object(c.useState)(""),n=Object(r.a)(a,2),i=n[0],u=n[1];function g(){return h.apply(this,arguments)}function h(){return(h=Object(s.a)(o.a.mark((function a(){var n;return o.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:if(""!==i){a.next=2;break}return a.abrupt("return");case 2:n={msg:i,roomName:t.roomName},m.a.post("".concat(e.config.backendURL,"/api/room/sendmessage"),n,{headers:{"milaap-auth-token":localStorage.getItem("milaap-auth-token")}}).then((function(e){console.log(e),t.callback(e.data.msg),u("")})).catch((function(e){console.log(e)}));case 4:case"end":return a.stop()}}),a)})))).apply(this,arguments)}return l.a.createElement("div",{className:"compose bg-dark"},l.a.createElement("textarea",{type:"text",className:"md-textarea form-control",placeholder:"Type a message, @name",value:i,onKeyDown:function(e){13===e.keyCode&&g()},onChange:function(e){u(e.target.value)},style:d.inputStyles}),l.a.createElement("button",{className:"compose-button",onClick:g},l.a.createElement("span",{className:"icon cui-chevron-right"})),t.rightItems)}var d={inputStyles:{borderRadius:"50px",backgroundColor:"white",marginRight:"5px",borderWidth:"2.5px",borderColor:"black"},composeStyles:{backgroundColor:"transparent",border:0,position:"fixed",bottom:"5",margin:0,padding:0},buttonStyles:{backgroundColor:"black"}}}).call(this,a(60))},548:function(e,t,a){},549:function(e,t,a){"use strict";a.d(t,"a",(function(){return s}));var n=a(1),o=a.n(n);a(550);function s(e){var t=e.title,a=e.leftItems,n=e.rightItems;return o.a.createElement("div",{className:"toolbar bg-dark"},o.a.createElement("div",{className:"left-items"},a),o.a.createElement("h1",{className:"toolbar-title"},t),o.a.createElement("div",{className:"right-items"},n))}},550:function(e,t,a){},551:function(e,t,a){"use strict";a.d(t,"a",(function(){return s}));var n=a(1),o=a.n(n);a(552);function s(e){var t=e.icon;return o.a.createElement("i",{className:"toolbar-button ".concat(t)})}},552:function(e,t,a){},553:function(e,t,a){"use strict";a.d(t,"a",(function(){return c}));var n=a(1),o=a.n(n),s=a(541),r=a.n(s);a(554);function c(e){var t=e.data,a=e.isMine,n=e.startsSequence,s=e.endsSequence,c=e.showTimestamp,l=r()(t.timestamp).format("LLLL");return o.a.createElement("div",{className:["message","".concat(a?"mine":""),"".concat(n?"start":""),"".concat(s?"end":"")].join(" ")},c&&o.a.createElement("div",{className:"timestamp bg-dark"},l),o.a.createElement("div",{className:"bubble-container"},o.a.createElement("b",{className:["sendBy","".concat(a)].join(" ")},!a&&t.sender),o.a.createElement("div",{className:["bubble","".concat(a?"mine":"")].join(" "),title:l},t.msg),o.a.createElement("b",null,a&&t.sender)))}},554:function(e,t,a){},555:function(e,t,a){},556:function(e,t,a){"use strict";(function(e){var n=a(538),o=a(539),s=a.n(o),r=a(540),c=a(163),l=a(164),i=a(167),m=a(166),u=a(165),d=a(530),g=a.n(d),h=a(1),p=a.n(h),f=a(527),v=a(581),b=(a(582),a(112)),y=a(614),E=a(612),k=(a(518),a(533),a(534),a(574)),N=a.n(k),S=a(523),C=a.n(S),O=a(583),j=a.n(O),w=(a(557),g()("".concat(e.config.backendURL,"/")),function(t){Object(m.a)(o,t);var a=Object(u.a)(o);function o(e){var t;return Object(c.a)(this,o),(t=a.call(this,e)).createNotif=function(e,t,a){f.store.addNotification({title:e,message:t,type:a,container:"top-right",animationIn:["animated","fadeIn"],animationOut:["animated","fadeOut"],dismiss:{duration:3e3,pauseOnHover:!0}})},t.switchContext=function(e){e.target&&(e=e.target);try{var t=document.getElementById("context");if(e.srcObject==t.srcObject)return;var a=e.nextElementSibling.innerText;t.style.display="inline",t.poster="https://dummyimage.com/1024x576/2f353a/ffffff.jpg&text="+a,t.srcObject=e.srcObject,t.play(),j()("#context").removeClass().addClass(e.id)}catch(n){console.log("The selected stream is old"),console.log(n)}},t.state={myIds:[0,0],myPeers:[0,0],roomName:t.props.roomName,remotePeers:new Set,remotePeersID:new Set,calls:new Array,connectedPeers:new Set,friendtkn:"",myUsername:""},console.log(t.state.roomName),t.startScreenShare=t.startScreenShare.bind(Object(i.a)(t)),t.startConnection=t.startConnection.bind(Object(i.a)(t)),t.sendCallEndedSignal=t.sendCallEndedSignal.bind(Object(i.a)(t)),t.endCall=t.endCall.bind(Object(i.a)(t)),t}return Object(l.a)(o,[{key:"componentWillUnmount",value:function(){this.endCall((function(){return console.log("Call ended")}))}},{key:"componentDidUpdate",value:function(e){console.log(e),console.log(this.props.roomName),this.props.roomName!==e.roomName&&(this.setState({roomName:this.props.roomName}),this.endCall())}},{key:"createPeer",value:function(e){return new N.a(e,{host:"localhost",port:9e3,path:"/peerserver",config:{iceServers:[{urls:"stun:stun.l.google.com:19302"},{url:"turn:numb.viagenie.ca",credential:"HWeF3pu@u2RfeYD",username:"veddandekar6@gmail.com"}]}})}},{key:"updateSelfPeerInfo",value:function(e,t,a,n){console.log(e.state);var o="video"===n?1:0;console.log(o),0!==e.state.myPeers[o]&&(e.state.myPeers[o].destroy(),e.deleteAllVideoElements(),e.setState({calls:new Array}));var s=e.state.myPeers,r=e.state.myIds;s[o]=t,r[o]=a,e.setState({myPeers:s,myIds:r}),console.log(e.state)}},{key:"startScreenShare",value:function(){var t=Object(r.a)(s.a.mark((function t(a,n){var o,r,c;return s.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return c=(o=this).createPeer(),t.next=4,c.on("open",(function(t){r=t;var s={roomName:o.state.roomName,tkn:r,type:a};C.a.post("".concat(e.config.backendURL,"/api/room/goonline"),s,{headers:{"milaap-auth-token":localStorage.getItem("milaap-auth-token")}}).then((function(e){console.log(e);var s=e.data.online;e.data.changePeer?(c.destroy(),c=o.createPeer(e.data.changePeer),console.log(c.disconnected),console.log("Using old Id"),console.log(c.connections),c.disconnected?(c.reconnect(),console.log("peer was disconnected, reconnecting..."),c.on("open",(function(e){console.log("reconnected"),console.log("My token: "+e),console.log("using older id: "+e),o.setUpConnections(o,c,e,a,s)}))):(c.reconnect(),o.setUpConnections(o,c,t,a,s)),n()):(console.log("My token: "+t),o.updateSelfPeerInfo(o,c,t,a),console.log(o.state),o.setUpConnections(o,c,t,a,s),n())})).catch((function(e){console.log(e),n(!1,"Failed")}))}));case 4:case"end":return t.stop()}}),t,this)})));return function(e,a){return t.apply(this,arguments)}}()},{key:"setUpConnections",value:function(e,t,a,n,o){var s=this;e.getMyMediaStream(e,n).then((function(a){e.waitForConnections(e,t),o.forEach((function(a,r){a.username===s.props.username&&a.type===n||(console.log("Connecting to "+o[r].tkn),e.startConnection(e,o[r].tkn,t))}))}))}},{key:"getMyMediaStream",value:function(){var e=Object(r.a)(s.a.mark((function e(t,a){return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("screen"!==a){e.next=5;break}return e.next=3,navigator.mediaDevices.getDisplayMedia({video:{width:1024,height:576},audio:!0}).then((function(e){return t.setState({myMediaStreamObj:e}),t.createVideoElement(t,e,"me"),e}));case 3:e.next=8;break;case 5:if("video"!==a){e.next=8;break}return e.next=8,navigator.mediaDevices.getUserMedia({video:{width:1024,height:576},audio:!0}).then((function(e){return t.setState({myMediaStreamObj:e}),t.createVideoElement(t,e,"me"),e}));case 8:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}()},{key:"startConnection",value:function(){var e=Object(r.a)(s.a.mark((function e(t,a,n){var o;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:console.log("starting connection with "+a),o=t.state.myMediaStreamObj,console.log(o),t.sendMediaStream(t,n,o,a,!1);case 4:case"end":return e.stop()}}),e)})));return function(t,a,n){return e.apply(this,arguments)}}()},{key:"waitForConnections",value:function(e,t){console.log("Waiting for connections....");var a=e.state.myMediaStreamObj;t.on("call",(function(n){e.sendMediaStream(e,t,a,null,!0,n)}))}},{key:"sendMediaStream",value:function(e,t,a,n,o,s){o&&(n=s.peer,console.log("Connected to "+n),console.log(s.metadata),this.createNotif("Member joined","".concat(s.metadata," joined the call"),"info"));var r=a.getTracks()[0],c=s;r.addEventListener("ended",(function(){console.log("My stream ended. Please show this"),c.close(),e.deleteVideoElement(c.peer)})),r.addEventListener("mute",(function(){console.log("My stream muted. Please show this")})),o?c.answer(a):(console.log(a.getTracks()),c=t.call(n,a,{metadata:this.state.myUsername})),e.addHandlersToCall(e,c,n,c.metadata,t,o)}},{key:"addHandlersToCall",value:function(e,t,a,o,s,r){t.on("error",(function(n){console.log("Connection failed for "+a),console.log(a),console.log(n),t.close(),e.deleteVideoElement(t.peer),r||console.log(a)})),t.on("stream",(function(s){console.log(s.getTracks()),console.log("stream received from"+t.peer);var r=e.state.calls;console.log(r);var c=!1;r.forEach((function(e,a){console.log("checking with "+e.peer),e.peer===t.peer&&(a,c=e)})),console.log(e.state.myIds),e.state.myIds.forEach((function(e,a){console.log("checking with "+e),e===t.peer&&(a,c=e)})),c&&(console.log("closing a duplicate call."),console.log(c.peer)),console.log(r),console.log(t),e.setState({calls:[].concat(Object(n.a)(r),[t])}),e.createStream(e,s,a,o)}))}},{key:"createStream",value:function(e,t,a,n){var o=t.getTracks()[0];t.onremovetrack=function(e){console.log("Track removed"),console.log(e)},o.addEventListener("ended",(function(){console.log("Receiving stream ended. Please show this")})),o.addEventListener("mute",(function(){console.log("muted. Please show this")})),console.log(t.getTracks()),e.createVideoElement(e,t,a,n)}},{key:"createVideoElement",value:function(e,t,a,n){var o=document.createElement("div"),s=document.createElement("video"),r=document.createElement("div"),c=document.getElementById("context");r.classList.add("name-label"),r.innerText=n||"me",s.width="200",s.id=a,"me"==s.id&&(s.muted="true"),s.height="350",s.srcObject=t,s.autoplay=!0,s.onclick=e.switchContext,o.appendChild(s),o.appendChild(r),document.getElementById("videos").appendChild(o),c.srcObject||e.switchContext(document.getElementById(a))}},{key:"clearContext",value:function(){var e=document.getElementById("context");null!=e&&(e.srcObject=null,e.style.display="none")}},{key:"deleteVideoElement",value:function(e){var t=document.getElementById(e),a=j()("#context");t&&(t.nextElementSibling.remove(),t.remove()),a.hasClass(e)&&this.clearContext()}},{key:"deleteAllVideoElements",value:function(){j()("#videos").empty(),this.clearContext()}},{key:"sendCallEndedSignal",value:function(){var t={roomName:this.state.roomName};C.a.post("".concat(e.config.backendURL,"/api/room/exitstream"),t,{headers:{"milaap-auth-token":localStorage.getItem("milaap-auth-token")}}).then((function(e){console.log(e.data)})).catch((function(e){console.log(e)}))}},{key:"sendRequestToEndCall",value:function(t){var a=this,n={roomName:this.state.roomName};C.a.post("".concat(e.config.backendURL,"/api/room/exitstream"),n,{headers:{"milaap-auth-token":localStorage.getItem("milaap-auth-token")}}).then((function(e){console.log(e.data);e.data.idToBeDestroyed;console.log(a.state.myPeers),a.state.myPeers.forEach((function(e,t){e&&e.destroy()})),a.setState({myIds:[0,0],myPeers:[0,0],remotePeers:new Set,remotePeersID:new Set,calls:new Array,connectedPeers:new Set,friendtkn:""}),t&&t()})).catch((function(e){console.log(e),t&&t(!1,"Error")}))}},{key:"endCall",value:function(){var e=Object(r.a)(s.a.mark((function e(t){var a=this;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.sendRequestToEndCall(t);case 2:this.state.myMediaStreamObj&&(this.state.myMediaStreamObj.getTracks().forEach((function(e){console.log(e),e.stop()})),this.state.myMediaStreamObj.getTracks().forEach((function(e){a.state.myMediaStreamObj.removeTrack(e)})),this.setState({myMediaStreamObj:null})),this.deleteAllVideoElements();case 4:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this;return p.a.createElement(y.a,null,p.a.createElement("br",null),p.a.createElement("br",null),p.a.createElement(E.a,{className:"justify-content-center text-center"},p.a.createElement(v.AwesomeButtonProgress,{type:"primary",size:"medium",action:function(t,a){e.startScreenShare("video",a)}},p.a.createElement("i",{className:"icon-user icons"}),p.a.createElement("span",null," Video")),p.a.createElement(v.AwesomeButtonProgress,{type:"primary",size:"medium",action:function(t,a){return e.startScreenShare("screen",a)}},p.a.createElement("i",{className:"icon-screen-desktop icons"}),p.a.createElement("span",null," Screen")),p.a.createElement(v.AwesomeButtonProgress,{type:"primary",size:"medium",disabled:!this.state.myMediaStreamObj,action:function(t,a){e.endCall(a)}},p.a.createElement("i",{className:"icon-call-end icons"}),p.a.createElement("span",null," End Call"))),p.a.createElement("br",null))}}]),o}(h.Component));t.a=Object(b.connect)((function(e){return console.log(e),{username:e.loginReducer.username}}))(w)}).call(this,a(60))},557:function(e,t,a){},558:function(e,t,a){"use strict";(function(e){var n=a(538),o=a(163),s=a(164),r=a(167),c=a(166),l=a(165),i=a(1),m=a.n(i),u=a(527),d=(a(559),a(530)),g=a.n(d),h=a(523),p=a.n(h),f=a(614),v=a(612),b=a(613),y=a(839),E=a(840),k=a(915),N=a(847),S=a(848),C=a(595),O=a(568),j=a(569),w=a(531),M=a(656),x=a(542),I=a(849),T=a(918),P=a(850),R=a(867),L=(a(562),g()("".concat(e.config.backendURL,"/")),function(t){Object(c.a)(i,t);var a=Object(l.a)(i);function i(e){var t;return Object(o.a)(this,i),(t=a.call(this,e)).loading=function(){return m.a.createElement("div",{className:"animated fadeIn pt-1 text-center"},"Loading...")},t.state={users:[],guests:[],newmember:"",modal:!1},t.toggle=t.toggle.bind(Object(r.a)(t)),t.addMember=t.addMember.bind(Object(r.a)(t)),t.handleNewMemberChange=t.handleNewMemberChange.bind(Object(r.a)(t)),t.shareLink=t.shareLink.bind(Object(r.a)(t)),t}return Object(s.a)(i,[{key:"shareLink",value:function(){var e=document.querySelector("link[rel=canonical]")?document.querySelector("link[rel=canonical]").href:document.location.href;navigator.share?navigator.share({title:"Join via Link",url:e}).then((function(){console.log("Link Shared!")})).catch(console.error):navigator.clipboard.writeText(e).then((function(){u.store.addNotification({title:"Link copied",message:"Link copied to clipboard!",type:"success",container:"top-right",animationIn:["animated","fadeIn"],animationOut:["animated","fadeOut"],dismiss:{duration:3e3,pauseOnHover:!0}})})).catch(console.log("Sorry try again"))}},{key:"toggle",value:function(){this.setState({modal:!this.state.modal})}},{key:"addMember",value:function(){var t=this,a={username:this.state.newmember,roomName:this.props.roomName};console.log(a),p.a.post("".concat(e.config.backendURL,"/api/room/addusertoroom"),a,{headers:{"milaap-auth-token":localStorage.getItem("milaap-auth-token")}}).then((function(e){console.log(e),200==e.status&&(t.toggle(),t.setState({users:[].concat(Object(n.a)(t.state.users),[a.username])}))})).catch((function(e){console.log(e)}))}},{key:"handleNewMemberChange",value:function(e){this.setState({newmember:e.target.value})}},{key:"componentDidUpdate",value:function(e){this.props.users!==e.users&&this.setState({users:this.props.users}),this.props.guests!==e.guests&&this.setState({guests:this.props.guests})}},{key:"render",value:function(){return m.a.createElement(f.a,{id:"memberlist"},m.a.createElement(v.a,null,m.a.createElement(b.a,null,m.a.createElement("h3",null," Members ")),m.a.createElement(b.a,null,m.a.createElement("i",{style:{cursor:"pointer"},class:"fa fa-user-plus",onClick:this.toggle}," ","Add"))),m.a.createElement("h5",null," Admins "),m.a.createElement(y.a,{flush:!0},this.state.users&&this.state.users.length>0?this.state.users.map((function(e){return m.a.createElement(E.a,{className:"bg-dark",key:Math.random()},e)})):"No members yet"),m.a.createElement("br",null),m.a.createElement(y.a,{flush:!0},m.a.createElement("h5",null," Guests "),this.state.guests&&this.state.guests.length>0?this.state.guests.map((function(e){return m.a.createElement(E.a,{className:"bg-dark",key:Math.random()},e)})):"No guests yet"),m.a.createElement(k.a,{isOpen:this.state.modal,toggle:this.toggle},m.a.createElement(N.a,{className:"bg-dark",toggle:this.toggle},"Add Members"),m.a.createElement(S.a,{className:"bg-dark"},m.a.createElement(C.a,null,m.a.createElement("h4",null,"Existing Members"),m.a.createElement(O.a,{className:"ml-2"},m.a.createElement(j.a,{addonType:"prepend"},m.a.createElement(w.a,{className:"bg-dark"},m.a.createElement("i",{className:"icon-user"}))),m.a.createElement(M.a,{type:"text",className:"mr-2 bg-dark text-light",placeholder:"Username",autoComplete:"username",value:this.state.newmember,onChange:this.handleNewMemberChange})," ",m.a.createElement(x.a,{color:"primary",onClick:this.addMember},"Add")),m.a.createElement("br",null),m.a.createElement("h4",null,"Invite Guests"),m.a.createElement(I.a,null,"Share the following link with the guest"),m.a.createElement(T.a,{style:{cursor:"pointer"},className:"p-2 m-2 bg-secondary text-dark",id:"linkHere",onClick:this.shareLink},document.querySelector("link[rel=canonical]")?document.querySelector("link[rel=canonical]").href:document.location.href),m.a.createElement(P.a,{placement:"bottom",target:"linkHere"},"Click to share"))),m.a.createElement(R.a,{className:"bg-dark"},m.a.createElement(x.a,{color:"success",onClick:this.toggle},"Close"))))}}]),i}(i.Component));t.a=L}).call(this,a(60))},562:function(e,t,a){}}]);
//# sourceMappingURL=13.3771fad2.chunk.js.map